<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Add Stripe tab to partner form -->
    <record id="view_partner_form_stripe" model="ir.ui.view">
        <field name="name">res.partner.form.stripe</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <notebook position="inside">
                <page string="Stripe" name="stripe_tab" invisible="supplier_rank == 0">
                    <group>
                        <group string="Stripe Account">
                            <field name="stripe_account_id" readonly="1"/>
                            <field name="stripe_account_type"/>
                            <field name="stripe_onboarding_completed" readonly="1"/>
                        </group>
                        <group string="Account Status">
                            <field name="stripe_charges_enabled" readonly="1"/>
                            <field name="stripe_payouts_enabled" readonly="1"/>
                        </group>
                    </group>
                    
                    <group string="Actions">
                        <button name="action_create_stripe_account" 
                                type="object" 
                                string="Create Stripe Account" 
                                class="btn-primary"
                                invisible="stripe_account_id != False"/>
                        
                        <button name="action_create_onboarding_link" 
                                type="object" 
                                string="Complete KYC Onboarding" 
                                class="btn-warning"
                                invisible="stripe_account_id == False or stripe_onboarding_completed == True"/>
                        
                        <button name="action_check_stripe_status" 
                                type="object" 
                                string="Check Status" 
                                class="btn-info"
                                invisible="stripe_account_id == False"/>
                    </group>
                    
                    <group string="Onboarding Link" invisible="stripe_account_link == False">
                        <field name="stripe_account_link" widget="url" readonly="1"/>
                        <div class="alert alert-info" role="alert">
                            <p>Send this link to the vendor to complete their KYC onboarding process.</p>
                        </div>
                    </group>
                </page>
            </notebook>
        </field>
    </record>
    
    <!-- Add Stripe status to partner tree view -->
    <record id="view_partner_tree_stripe" model="ir.ui.view">
        <field name="name">res.partner.tree.stripe</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <field name="phone" position="after">
                <field name="stripe_onboarding_completed" optional="hide" widget="boolean_toggle"/>
                <field name="stripe_payouts_enabled" optional="hide" widget="boolean_toggle"/>
            </field>
        </field>
    </record>
</odoo>