<?xml version='1.0' encoding='UTF-8'?>
<odoo>
    <record id="vpicktree" model="ir.ui.view">
        <field name="name">stock.picking.list.inherit.ecommerce</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <field name="state" position="after">
                <field
                    name="ecommerce_sync_status"
                    widget="badge"
                    optional="hide"
                    decoration-info="ecommerce_sync_status == 'pending'"
                    decoration-success="ecommerce_sync_status == 'done'"
                    decoration-danger="ecommerce_sync_status == 'error'"
                />
                <field
                    name="ecommerce_picking_identifier"
                    groups="base.group_no_one"
                    optional="hide"
                />
            </field>
        </field>
    </record>
    <record id="view_picking_form" model="ir.ui.view">
        <field name="name">stock.picking.form.inherit.ecommerce</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.view_picking_form"/>
        <field name="arch" type="xml">
            <div name="button_box" position="after">
                <div class="badge rounded-pill text-bg-info fs-6 float-end"
                     invisible="not support_update_picking or ecommerce_sync_status != 'pending'">
                    Scheduled for Synchronization with E-commerce Platform
                </div>
                <div class="badge rounded-pill text-bg-success fs-6 float-end"
                     invisible="not support_update_picking or ecommerce_sync_status != 'done'">
                    Synchronized with E-commerce Platform
                </div>
                <div class="badge rounded-pill text-bg-danger fs-6 float-end"
                     invisible="not support_update_picking or ecommerce_sync_status != 'error'">
                    Synchronization with E-commerce Platform failed
                </div>
            </div>
            <field name="origin" position="after">
                <field name="ecommerce_picking_identifier" invisible="not ecommerce_picking_identifier" groups="base.group_no_one"/>
            </field>
            <xpath expr="//button[@name='%(stock.act_stock_return_picking)d']" position="after">
                <button
                    name="action_update_pickings_to_ecommerce"
                    string="Update to E-commerce"
                    invisible="not support_update_picking or ecommerce_sync_status == 'done'"
                    type="object"
                />
            </xpath>
        </field>
    </record>
    <record id="action_process_failed_picking" model="ir.actions.server">
        <field name="name">Process Failed Picking</field>
        <field name="model_id" ref="stock.model_stock_picking"/>
        <field name="binding_model_id" ref="stock.model_stock_picking"/>
        <field name="binding_view_types">list</field>
        <field name="state">code</field>
        <field name="code">action = records.action_update_failed_pickings_to_ecommerce()</field>
    </record>
</odoo>
