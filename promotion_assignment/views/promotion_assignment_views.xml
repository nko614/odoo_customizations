<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- ============================================================ -->
    <!-- Search view                                                   -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_view_search" model="ir.ui.view">
        <field name="name">promotion.assignment.search</field>
        <field name="model">promotion.assignment</field>
        <field name="arch" type="xml">
            <search string="Promotions">
                <field name="customer_id"/>
                <field name="product_id"/>
                <separator/>
                <filter name="filter_internal" string="Internal"
                    domain="[('promotion_type', '=', 'internal')]"/>
                <filter name="filter_mailing" string="Mailing"
                    domain="[('promotion_type', '=', 'mailing')]"/>
                <filter name="filter_social" string="Social Media"
                    domain="[('promotion_type', '=', 'social_media')]"/>
                <separator/>
                <group>
                    <filter name="group_month" string="Month"
                        context="{'group_by': 'month'}"/>
                    <filter name="group_customer" string="Customer"
                        context="{'group_by': 'customer_id'}"/>
                    <filter name="group_product" string="Product"
                        context="{'group_by': 'product_id'}"/>
                    <filter name="group_type" string="Promotion Type"
                        context="{'group_by': 'promotion_type'}"/>
                    <filter name="group_category" string="Category"
                        context="{'group_by': 'category'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- ============================================================ -->
    <!-- Tree / list view                                              -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_view_list" model="ir.ui.view">
        <field name="name">promotion.assignment.list</field>
        <field name="model">promotion.assignment</field>
        <field name="arch" type="xml">
            <list string="Promotion Assignments">
                <field name="month" column_invisible="1"/>
                <field name="customer_id"/>
                <field name="product_id"/>
                <field name="discount_pct" string="Discount %"/>
                <field name="date_start"/>
                <field name="date_end"/>
                <field name="promotion_type"/>
                <field name="category"/>
                <field name="total_revenue" sum="Total Revenue"/>
            </list>
        </field>
    </record>

    <!-- ============================================================ -->
    <!-- Form view                                                     -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_view_form" model="ir.ui.view">
        <field name="name">promotion.assignment.form</field>
        <field name="model">promotion.assignment</field>
        <field name="arch" type="xml">
            <form string="Promotion Assignment">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="action_view_sale_lines"
                                type="object"
                                class="oe_stat_button"
                                icon="fa-shopping-cart">
                            <field name="sale_line_count" widget="statinfo"
                                   string="Sales"/>
                        </button>
                    </div>
                    <group>
                        <group string="Assignment">
                            <field name="customer_id"/>
                            <field name="product_id"/>
                            <field name="discount_pct"/>
                        </group>
                        <group string="Period">
                            <field name="date_start"/>
                            <field name="date_end"/>
                            <field name="month"/>
                        </group>
                    </group>
                    <group>
                        <group string="Classification">
                            <field name="promotion_type"/>
                            <field name="category"/>
                        </group>
                        <group string="Performance">
                            <field name="total_revenue"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- ============================================================ -->
    <!-- Gantt view — product on Y-axis, time on X-axis               -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_view_gantt" model="ir.ui.view">
        <field name="name">promotion.assignment.gantt</field>
        <field name="model">promotion.assignment</field>
        <field name="arch" type="xml">
            <gantt date_start="date_start"
                   date_stop="date_end"
                   default_scale="month"
                   scales="week,month,quarter,year"
                   string="Promotion Timeline"
                   default_group_by="product_id">
                <field name="customer_id"/>
                <field name="discount_pct"/>
            </gantt>
        </field>
    </record>

    <!-- ============================================================ -->
    <!-- Pivot view — customer rows x product columns x discount/rev  -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_view_pivot" model="ir.ui.view">
        <field name="name">promotion.assignment.pivot</field>
        <field name="model">promotion.assignment</field>
        <field name="arch" type="xml">
            <pivot string="Promotion Matrix" sample="1">
                <field name="customer_id" type="row"/>
                <field name="product_id" type="col"/>
                <field name="discount_pct" type="measure"/>
                <field name="total_revenue" type="measure"/>
            </pivot>
        </field>
    </record>

    <!-- ============================================================ -->
    <!-- Action                                                        -->
    <!-- ============================================================ -->
    <record id="promotion_assignment_action" model="ir.actions.act_window">
        <field name="name">Promotion Assignments</field>
        <field name="res_model">promotion.assignment</field>
        <field name="view_mode">list,form,gantt,pivot</field>
        <field name="search_view_id" ref="promotion_assignment_view_search"/>
        <field name="context">{
            'search_default_group_month': 1,
            'search_default_group_customer': 2,
        }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create your first promotion assignment
            </p>
            <p>
                Assign exclusive promotional discounts to customers for specific
                products during defined time periods.
            </p>
        </field>
    </record>

</odoo>
